<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="./AT-PAC_favicon.ico">
    <link rel="stylesheet" href="./assets/css/styles.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

    <title>Material Calculator</title>
</head>
<body>
    <!-- Navigation -->
    <section id="nav">
        <nav class="navbar" class="container-fluid">
            <img class="logo-img" src="./assets/images/logo-no-subtext-544w.png" alt="logo-img">
        </nav>
    </section>

    <!-- Calculation -->
    <section id="calculation" class="row container-fluid">
        <!-- Form -->
        <div id="input-form" class="col-md-6">
            <form action="" >
                <div class="calculator-input row">
                    <label class="col-4" for="projectTitle" id="project-title">Project Title</label>
                    <input class="col-8" type="text" class="form-control" id="projectTitle">
                </div>
                <br>
                <div class="calculator-input row">
                    <label class="col-4" for="scaffoldLength" class="input-label">Scafold Length (ft)</label>
                    <input class="col-8" type="number" min="0"  class="form-control" id="scaffoldLength">
                </div>
                <br>
                <div class="calculator-input row">
                    <label class="col-4" for="scaffoldHeight" class="input-label">Scafold Height (ft)</label>
                    <input class="col-8" type="number" min="0"  class="form-control" id="scaffoldHeight" name="scaffoldHeight">
                </div>
                <br>
                <div class="calculator-input row">
                    <label class="col-4" for="scaffoldHeight" class="input-label">Scafold Height (ft)</label>
                    <input class="col-8" type="number" min="0"  class="form-control" id="scaffoldHeight" name="scaffoldHeight">
                </div>
                <br>
                <div class="calculator-input row">
                    <label class="col-4" for="numDecked" class="input-label">Number of Decked Levels</label>
                    <input class="col-8" type="number" min="0"  class="form-control" id="scaffoldHeight" name="scaffoldHeight">
                </div>
                <br>
                <div class="calculator-input row">
                    <label class="col-4" for="scaffoldBayWidth" class="input-label">Preferred Bay Width</label>
                    <select class="col-8" name="scaffoldBayWidth" id="scaffoldBayWidth" class="form-control">
                        <option value="01.03.015.00" data-length="0.15">Ledger O-Type 0'-6"</option>
                        <option value="01.03.061.00" data-length="0.61">Ledger O-Type 2'-0"</option>
                        <option value="01.03.065.00" data-length="0.65">Ledger O-Type 2'-2"</option>
                        <option value="01.03.088.00" data-length="0.88">Ledger O-Type 2'-10 5/8"</option>
                        <option value="01.03.091.00" data-length="0.91">Ledger O-Type 3'-0"</option>
                        <option value="01.03.106.00" data-length="1.065">Ledger O-Type 3'-6"</option>
                        <option value="01.03.109.00" data-length="1.09">Ledger O-Type 3'-7"</option>
                        <option value="01.03.115.00" data-length="1.15">Ledger O-Type 3'-10"</option>
                        <option value="01.03.121.00" data-length="1.21">Ledger O-Type 4'-0"</option>
                        <option value="01.03.128.00" data-length="1.28">Ledger O-Type 4'-2"</option>
                        <option value="01.03.152.00" data-length="1.52">Ledger O-Type 5'-0"</option>
                        <option value="01.03.157.00" data-length="1.57">Ledger O-Type 5'-2"</option>
                        <option value="01.03.182.00" data-length="1.82">Ledger O-Type 6'-0"</option>
                        <option value="01.03.213.00" data-length="2.13">Ledger O-Type 7'-0"</option>
                        <option value="01.03.243.00" data-length="2.43">Ledger O-Type 8'-0"</option>
                        <option value="01.03.305.00" data-length="3.05">Ledger O-Type 10'-0"</option>
                    </select>
                </div>
                <br>
                <div class="calculator-input row">
                    <label class="col-4" for="scaffoldBayLength" class="input-label">Preferred Bay Length</label>
                    <select class="col-8" name="scaffoldBayLength" id="scaffoldBayLength" class="form-control">
                        <option value="01.03.015.00" data-length="0.15">Ledger O-Type 0'-6"</option>
                        <option value="01.03.061.00" data-length="0.61">Ledger O-Type 2'-0"</option>
                        <option value="01.03.065.00" data-length="0.65">Ledger O-Type 2'-2"</option>
                        <option value="01.03.088.00" data-length="0.88">Ledger O-Type 2'-10 5/8"</option>
                        <option value="01.03.091.00" data-length="0.91">Ledger O-Type 3'-0"</option>
                        <option value="01.03.106.00" data-length="1.065">Ledger O-Type 3'-6"</option>
                        <option value="01.03.109.00" data-length="1.09">Ledger O-Type 3'-7"</option>
                        <option value="01.03.115.00" data-length="1.15">Ledger O-Type 3'-10"</option>
                        <option value="01.03.121.00" data-length="1.21">Ledger O-Type 4'-0"</option>
                        <option value="01.03.128.00" data-length="1.28">Ledger O-Type 4'-2"</option>
                        <option value="01.03.152.00" data-length="1.52">Ledger O-Type 5'-0"</option>
                        <option value="01.03.157.00" data-length="1.57">Ledger O-Type 5'-2"</option>
                        <option value="01.03.182.00" data-length="1.82">Ledger O-Type 6'-0"</option>
                        <option value="01.03.213.00" data-length="2.13">Ledger O-Type 7'-0"</option>
                        <option value="01.03.243.00" data-length="2.43">Ledger O-Type 8'-0"</option>
                        <option value="01.03.305.00" data-length="3.05">Ledger O-Type 10'-0"</option>
                    </select>
                </div>
                <br>
                <button class="btn btn-dark" id="calculateMTO">Calculate MTO</button>

            </form>
        </div>

        <!-- Result Table -->
        <div id="output-table" class="col-md-4">

        </div>
    </section>
        
    <!-- Javascript -->
    <script>
        // Defining Variables
        var projectTitle = "";
        var scaffoldLength=0;
        var scaffoldHeight=0;
        var scaffoldBayLength=0;
        var scaffoldBayWidth=0;
        var numBayLength;
        var numBayWidth;
        var resultMTO = [];
        var materialData = new Object();

        // Get Material Data from json file and assign to material data
        $.getJSON( "./material_data_min.json", function( data ) {
            materialData = {...data};
        }).then(()=>{
            // console.log(materialData)
            // DO SOMETHING TO LET USER KNOW DATA IS LOADED
        })
        .fail((error)=>{
            console.log("Error:", error)
        });
        
        // Get Number of Bay Based on total length and each bay length
        const getNumSegment = (totalLength, bayLength) => {
            var result = {
                numSegment: Math.floor(totalLength/bayLength),
                remainderLength: totalLength%bayLength
            };   
            return result;
        };

        // Get scaffold bay length item
        const getBayLengthItem = (totalLength, preferredBay) => {
            var numBayLength = getNumSegment(totalLength, preferredBay);
            console.log("total length=", totalLength, "preferredBay=",preferredBay)
            for (i of materialData.material_data_min) {
                
                console.log("remainder=", numBayLength.remainderLength, "Ledgerlength=", i.length_m)
                console.log("remainer / target ledger length=", numBayLength.remainderLength / i.length_m)

                // if(Math.floor(numBayLength.remainderLength / i.length_m)==0){
                //     console.log("remainer=", numBayLength.remainderLength, "Ledgerlength=", i.length_m)
                // } else {
                //     console.log("no")
                // }
            };
        };



        // Onlick Calculate MTO to gather input variables
        $(document).on("click","#calculateMTO",function(event){
            event.preventDefault();
            projectTitle = $("#projectTitle").val().trim();
            scaffoldLength = parseInt($("#scaffoldLength").val())*0.3048 //scaffold length is in meter;
            scaffoldHeight = parseInt($("#scaffoldHeight").val())*0.3048 //scaffold width is in meter;
            scaffoldBayWidth = $("#scaffoldBayWidth").find(':selected').data('length') //in meter;
            scaffoldBayLength = $("#scaffoldBayLength").find(':selected').data('length') //in meter;

            numLift = Math.round(scaffoldHeight/2); //assuming 2m lift
            getBayLengthItem(scaffoldLength, scaffoldBayLength)
        })
        
    </script>
</body>
</html>